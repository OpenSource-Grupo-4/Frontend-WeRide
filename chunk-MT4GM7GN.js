import{a as w}from"./chunk-WSXCBBDC.js";import{b as D}from"./chunk-NRTV435P.js";import{a as V}from"./chunk-ON2FZFZ2.js";import"./chunk-2WQAUUU7.js";import{c as O}from"./chunk-RFKOBGZG.js";import{M as P}from"./chunk-OG6XGFB4.js";import{j as S,s as T}from"./chunk-7GAM2AWN.js";import"./chunk-K56FZ7PP.js";import"./chunk-QHL7TNPJ.js";import{Kb as x,Lb as n,Mb as o,Nb as k,Tb as C,Xb as d,Ya as b,Yb as v,_a as s,ha as g,lb as y,lc as a,na as f,nc as l,oa as h,rb as M}from"./chunk-EYER3JCQ.js";function j(p,e){if(p&1){let t=C();n(0,"div",6),k(1,"img",7),n(2,"div",8)(3,"h3"),a(4),o(),n(5,"p"),a(6),o(),n(7,"p"),a(8),o(),n(9,"p"),a(10),o(),n(11,"p"),a(12),o(),n(13,"p"),a(14),o()(),n(15,"div",9)(16,"button",10),d("click",function(){let r=f(t).$implicit,c=v();return h(c.printReceipt(r))}),a(17,"Imprimir recibo"),o(),n(18,"button",10),d("click",function(){let r=f(t).$implicit,c=v();return h(c.viewDetails(r))}),a(19,"Ver detalles"),o()()()}if(p&2){let t=e.$implicit;s(),x("src",t.image,b),s(3),l("Viaje (",t.route,")"),s(2),l("Fecha y hora: ",t.date),s(2),l("Veh\xEDculo: ",t.vehicle),s(2),l("Duraci\xF3n del viaje: ",t.duration),s(2),l("Distancia recorrida: ",t.distance),s(2),l("Id del Viaje: ",t.id)}}var E=class p{router=g(O);tripService=g(V);vehicleService=g(w);trips=[];loading=!1;ngOnInit(){this.loadTrips()}loadTrips(){this.loading=!0,this.tripService.loadTrips().subscribe({next:e=>{if(!e||e.length===0){this.trips=[],this.loading=!1;return}this.vehicleService.loadVehicles().subscribe({next:t=>{this.trips=e.map(i=>{let r=t.find($=>$.id===i.vehicleId),c=new Date(i.startDate),u=this.formatDate(c),m=Math.floor(i.duration/60),_=i.duration%60,I=m>0?`${m}h${_}min`:`${_} min`;return{route:this.formatRoute(i.route),date:u,vehicle:r?`${r.brand} ${r.model}`:"Veh\xEDculo no encontrado",duration:I,distance:`${i.distance} km`,id:i.id,image:r?.image||"assets/vehicles/default.jpg"}}),this.loading=!1},error:t=>{console.error("Error loading vehicles:",t),this.loading=!1}})},error:e=>{console.error("Error loading trips:",e),this.loading=!1}})}formatRoute(e){let t=e.split("\u2192");return t.length>=2?`${t[0].trim()} - ${t[t.length-1].trim()}`:e}formatDate(e){let t=["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sept","Oct","Nov","Dic"],i=e.getDate(),r=t[e.getMonth()],c=e.getHours().toString().padStart(2,"0"),u=e.getMinutes().toString().padStart(2,"0"),m=e.getHours()>=12?"PM":"AM";return`${i} ${r}, ${c}:${u} ${m}`}printReceipt(e){alert("Imprimiendo recibo del viaje: "+e.id)}viewDetails(e){alert("Mostrando detalles del viaje: "+e.id)}seeMore(){alert("Cargando m\xE1s viajes...")}goBack(){this.router.navigate(["/trip"])}static \u0275fac=function(t){return new(t||p)};static \u0275cmp=y({type:p,selectors:[["app-trip-history"]],decls:10,vars:1,consts:[[1,"trip-history-container"],[1,"header"],["mat-icon-button","","aria-label","Volver",1,"back-btn",3,"click"],[2,"font-size","24px"],["class","trip-card",4,"ngFor","ngForOf"],[1,"see-more-btn",3,"click"],[1,"trip-card"],["alt","Scooter",1,"vehicle-img",3,"src"],[1,"trip-info"],[1,"trip-actions"],[3,"click"]],template:function(t,i){t&1&&(n(0,"div",0)(1,"div",1)(2,"button",2),d("click",function(){return i.goBack()}),n(3,"span",3),a(4,"\u2190"),o()(),n(5,"h2"),a(6,"Historial de Viajes"),o()(),M(7,j,20,7,"div",4),n(8,"button",5),d("click",function(){return i.seeMore()}),a(9,"Ver m\xE1s"),o()()),t&2&&(s(7),x("ngForOf",i.trips))},dependencies:[D,P,T,S],styles:[".trip-history-container[_ngcontent-%COMP%]{max-width:900px;margin:40px auto}.header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:20px;margin-bottom:30px}.back-arrow[_ngcontent-%COMP%]{font-size:2rem;cursor:pointer}.trip-card[_ngcontent-%COMP%]{display:flex;align-items:flex-start;border:2px solid #222;border-radius:12px;padding:24px;margin-bottom:24px;background:#fff;gap:24px}.vehicle-img[_ngcontent-%COMP%]{width:120px;height:auto;object-fit:contain}.trip-info[_ngcontent-%COMP%]{flex:1}.trip-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 8px;font-size:1.15rem;font-weight:700}.trip-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:2px 0;font-size:1rem}.trip-actions[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px;min-width:220px;justify-content:center}.trip-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:8px 0;border:2px solid #222;border-radius:8px;background:#fff;font-size:1rem;cursor:pointer;transition:background .2s}.trip-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background:#eee}.see-more-btn[_ngcontent-%COMP%]{display:block;width:350px;margin:32px auto 0;padding:10px 0;background:#7c4dff;color:#fff;border:none;border-radius:24px;font-size:1.1rem;cursor:pointer;transition:background .2s}.see-more-btn[_ngcontent-%COMP%]:hover{background:#5e35b1}"]})};export{E as TripHistory};
