<div class="payment-container">
  <div class="payment-form">
    <div class="form-group">
      <label>Numero de tarjeta</label>
      <div class="input-wrapper">
        <input
          type="text"
          placeholder="Numero de tarjeta"
          [(ngModel)]="cardNumber"
          (input)="onCardNumberInput($event)"
          maxlength="19"
          class="card-input"
        />
        <mat-icon class="input-icon success" *ngIf="isCardNumberValid()">
          check_circle
        </mat-icon>
      </div>
    </div>

    <div class="form-row">
      <div class="form-group">
        <label>Fecha de</label>
        <input
          type="text"
          placeholder="MM/AA"
          [(ngModel)]="expiryDate"
          (input)="onExpiryDateInput($event)"
          maxlength="5"
          class="date-input"
        />
      </div>

      <div class="form-group">
        <label>CVV</label>
        <div class="input-wrapper">
          <input
            type="password"
            placeholder="3-4 digitos"
            [(ngModel)]="cvv"
            maxlength="4"
            class="cvv-input"
          />
          <mat-icon class="input-icon lock">lock</mat-icon>
        </div>
      </div>
    </div>

    <div class="save-card-row">
      <span>Recordar esta tarjeta para uso futuro</span>
      <mat-slide-toggle [(ngModel)]="saveCard" color="primary"></mat-slide-toggle>
    </div>

    <div class="billing-section">
      <div class="billing-header">
        <label>Direccion de facturación</label>
        <button class="edit-btn" (click)="editAddress()">Editar</button>
      </div>
      <p class="billing-address">{{ billingAddress }}</p>
    </div>

    <div class="price-summary">
      <div class="price-row">
        <span>Total :</span>
        <span class="price">S/ {{ subtotal.toFixed(2) }}</span>
      </div>
      <div class="price-row discount-row">
        <span>Descuento(s):</span>
        <span class="price">S/ {{ discount.toFixed(2) }}</span>
      </div>
      <div class="price-row total-row">
        <span>Total:</span>
        <span class="price total">S/ {{ total.toFixed(2) }}</span>
      </div>
    </div>

    <div class="reminder">
      <p class="reminder-title">Recuerda:</p>
      <p class="reminder-text">Los viajes de más de 30 minutos generán costos extra</p>
    </div>

    <div class="payment-total">
      <p class="payment-total-label">Total del Pago:</p>
      <p class="payment-total-amount">S/ {{ total.toFixed(2) }}</p>
      <p class="payment-terms">
        Al finalizar la compra, acepta nuestros
        <a href="/terms">términos de uso</a> y la
        <a href="/privacy">Política de privacidad</a>.
      </p>
    </div>

    <button
      class="finalize-btn"
      [disabled]="!isFormValid()"
      (click)="endPayment()"
    >
      Finalizar Pago S/ {{ total.toFixed(2) }}
    </button>
  </div>
</div>
