<div class="plan-detail-container">
  <ng-container *ngIf="loading$ | async; else contentTemplate">
    <div class="loading">Cargando plan...</div>
  </ng-container>

  <ng-template #contentTemplate>
    <ng-container *ngIf="plan$ | async as plan; else notFoundTemplate">
      <mat-card class="plan-detail-card">
        <mat-card-header>
          <mat-card-title [style.color]="plan.color"
            >{{ plan.name }}</mat-card-title
          >
        </mat-card-header>
        <mat-card-content>
          <p class="plan-description">{{ plan.description }}</p>
          <div class="plan-info">
            <p><strong>Duración:</strong> {{ getFormattedDuration(plan) }}</p>
            <p><strong>Precio:</strong> {{ getFormattedPrice(plan) }}</p>
            <p>
              <strong>Precio por minuto:</strong> ${{ plan.pricePerMinute }}
            </p>
            <p><strong>Descuento:</strong> {{ plan.discountPercentage }}%</p>
            <p>
              <strong>Viajes máximos por día:</strong> {{ plan.maxTripsPerDay }}
            </p>
            <p>
              <strong>Minutos máximos por viaje:</strong> {{
              plan.maxMinutesPerTrip }}
            </p>
            <p>
              <strong>Minutos gratis al mes:</strong> {{
              plan.freeMinutesPerMonth }}
            </p>
          </div>
          <div class="plan-benefits">
            <h4>Beneficios:</h4>
            <ul>
              <li *ngFor="let benefit of plan.benefits">{{ benefit }}</li>
            </ul>
          </div>
        </mat-card-content>
        <mat-card-actions>
          <button mat-raised-button color="primary" (click)="onPayment(plan)">
            Pagar
          </button>
        </mat-card-actions>
      </mat-card>
    </ng-container>

    <ng-template #notFoundTemplate>
      <div>
        <p>Plan no encontrado.</p>
      </div>
    </ng-template>
  </ng-template>
</div>
